# 完整部署方案 - 前端+后端一起部署

## 部署策略

由于前端和后端是分开的，需要分别部署：

1. **前端（Pages）**：使用 "导入 Github 仓库" 方式
2. **后端（边缘函数）**：使用 "函数模板" 方式

## 方案一：分别部署（推荐）

### 步骤1：部署前端（Pages）

1. 在控制台选择 **"导入 Github 仓库"** (Import Github Repository)
2. 连接您的GitHub仓库：`mathCrazyy/drug_serve2`
3. 选择分支：`main`
4. 系统会自动识别 `esa.jsonc` 配置文件
5. 配置环境变量（部署后配置）：
   - `VITE_API_BASE_URL` = 边缘函数URL（部署后端后获取）
6. 点击部署

### 步骤2：部署后端（边缘函数）

1. 切换到 **"函数模板"** (Function Template) 标签
2. 选择 **"Hello World"** 模板
3. 创建函数后，需要手动上传代码（见下方）

## 方案二：使用CLI工具（如果支持）

如果控制台有 **"使用 CLI 创建函数"** 选项，可以使用命令行工具批量部署。

## 当前情况说明

**为什么不能一起部署？**

- **Pages**：用于部署静态前端应用（React）
- **Functions**：用于部署服务端逻辑（Node.js边缘函数）
- 它们是不同的服务，需要分别创建和部署

## 快速操作指南

### 前端部署（已完成）

✅ 您的前端已经通过GitHub自动部署成功了！

### 后端部署（需要完成）

1. 点击 **"函数模板"** 标签
2. 选择 **"Hello World"** 模板
3. 创建函数：`drug-recognize`
4. 在代码编辑器中，替换所有文件内容

## 手动上传代码步骤

由于没有ZIP上传功能，需要在代码编辑器中逐个创建文件：

### 文件结构

```
index.js              (主入口)
config.js             (配置文件)
package.json          (依赖配置)
handlers/
  ├── recognize.js
  ├── history.js
  └── merge.js
utils/
  ├── doubaoApi.js
  ├── parser.js
  └── storage.js
```

### 操作步骤

1. 删除模板生成的默认文件
2. 创建根目录文件：
   - `index.js`
   - `config.js`
   - `package.json`
3. 创建目录并添加文件：
   - 创建 `handlers` 目录，添加3个文件
   - 创建 `utils` 目录，添加3个文件
4. 复制每个文件的内容（我会提供所有文件内容）

## 建议

**最简单的方式**：
1. 前端：已经通过GitHub部署完成 ✅
2. 后端：选择"函数模板" → "Hello World" → 手动替换代码

需要我提供所有文件的完整代码内容吗？这样您可以直接复制粘贴。

